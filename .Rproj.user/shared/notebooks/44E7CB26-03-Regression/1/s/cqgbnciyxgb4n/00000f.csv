"0","library(latex2exp)"
"2","Warning:"
"2"," package ‘latex2exp’ was built under R version 4.3.3
"
"0","output = data.frame(x=numeric(0),y_hat=numeric(0),alpha=numeric(0))"
"0",""
"0","# Calculate centered Abdomen circumference"
"0","X = bodyfat$Abdomen-mean(bodyfat$Abdomen)"
"0",""
"0","n = length(X)"
"0","new_x = seq(min(bodyfat$Abdomen), max(bodyfat$Abdomen), length.out = 100)"
"0",""
"0","for(alpha in c(0.001,0.01,0.1,1,10,n)){"
"0","  "
"0","  # Fit Bayesian linear model using g-prior and the current value of alpha"
"0","  bodyfat.blm = bas.lm(bodyfat$Bodyfat ~ X, prior=""g-prior"", alpha=alpha,"
"0","                       modelprior=Bernoulli(1))"
"0","  "
"0","  # Extract the posterior means of the intercept and the beta coefficients"
"0","  intercept = coef(bodyfat.blm)$postmean[1]"
"0","  beta = coef(bodyfat.blm)$postmean[2]"
"0","  "
"0","  # Calculate the predicted value of body fat percentage for the values in the "
"0","  # range of Abdomen circumference"
"0","  y_hat = intercept + beta *(new_x - mean(bodyfat$Abdomen))"
"0","  "
"0","  # Append the results to the output data frame"
"0","  output = rbind(output, data.frame(x = new_x, y_hat = y_hat, alpha=alpha))"
"0","}"
"0",""
"0","output$alpha = as.factor(output$alpha)"
"0",""
"0","# Plot"
"0","plot1 = ggplot(data = bodyfat, aes(x = Abdomen, y = Bodyfat)) + "
"0","  geom_point(color = ""steelblue"") + xlab(""Abdomen circumference (cm)"") +"
"0","  geom_line(data = output, aes(x = x, y=y_hat, group=alpha, color=alpha),lty=1) +"
"0","  scale_colour_manual(values=rainbow(length(levels(output$alpha))),name=TeX(""$\\alpha$"")) "
"0","plot1"
