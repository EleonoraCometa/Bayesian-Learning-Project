"0","# Construct current prediction"
"0","alpha = bodyfat.lm$coefficients[1]"
"0","beta = bodyfat.lm$coefficients[2]"
"0","new_x = seq(min(bodyfat$Abdomen), max(bodyfat$Abdomen), "
"0","            length.out = 100)"
"0",""
"0","y_hat = alpha + beta * new_x"
"0",""
"0","# Get lower and upper bounds for mean"
"0","ymean = data.frame(predict(bodyfat.lm,"
"0","                           newdata = data.frame(Abdomen = new_x),"
"0","                           interval = ""confidence"","
"0","                           level = 0.95))"
"0",""
"0","# Get lower and upper bounds for prediction"
"0","ypred = data.frame(predict(bodyfat.lm,"
"0","                           newdata = data.frame(Abdomen = new_x),"
"0","                           interval = ""prediction"","
"0","                           level = 0.95))"
"0",""
"0","output = data.frame(x = new_x, y_hat = y_hat,"
"0","                    ymean_lwr = ymean$lwr, ymean_upr = ymean$upr,"
"0","                    ypred_lwr = ypred$lwr, ypred_upr = ypred$upr)"
"0",""
"0","# Plot"
"0","plot1 = ggplot(data = bodyfat, aes(x = Abdomen, y = Bodyfat)) + "
"0","  geom_point(color = ""steelblue"") + xlab(""Abdomen circumference (cm)"") +"
"0","  geom_line(data = output, aes(x = new_x, y = y_hat, color = ""first""),lty=1) +"
"0","  geom_line(data = output, aes(x = new_x, y = ymean_lwr, lty = ""second"")) +"
"0","  geom_line(data = output, aes(x = new_x, y = ymean_upr, lty = ""second"")) +"
"0","  geom_line(data = output, aes(x = new_x, y = ypred_upr, lty = ""third"")) +"
"0","  geom_line(data = output, aes(x = new_x, y = ypred_lwr, lty = ""third"")) + "
"0","  scale_colour_manual(values=""darkorange"", labels=""Posterior Mean"", name="""") +"
"0","  scale_linetype_manual(values = c(1, 2), labels = c(""Mean"", ""Predictions""),"
"0","                        name = ""95% C.I."")"
"0","plot1"
