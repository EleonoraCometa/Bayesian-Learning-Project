"0","# Construct the new design matrix"
"0","p = 3"
"0","X = matrix(c(rep(1,n),x,x^2),n,p)"
"0",""
"0","# Prior hyperparameters (non-informative)"
"0","m0 <- matrix(0,p,1)"
"0","S0 <- diag(x=1000,p,p)"
"0",""
"0","# Posterior parameters"
"0","SN <- solve(solve(S0) + t(X) %*% X/sigma2)"
"0","mN <- SN %*% (solve(S0) %*% m0 + t(X) %*% y/sigma2)"
"0",""
"0","# Predictive distribution in the same points"
"0","y_hat <- t(mN) %*% t(X)"
"0","sigma2_hat <- array(0, n)"
"0","for(i in 1:n){"
"0"," sigma2_hat[i] <- sigma2 + X[i,] %*% SN %*% X[i,]"
"0","}"
"0",""
"0","# Plot"
"0","g_bayes <- g1 + "
"0","  geom_line(aes(x=x,y=y_hat[1,], color=""Predictive""), linewidth=1) +"
"0","  geom_function(aes(color=""True Function""), fun = f, linewidth=1) +"
"0","  geom_ribbon(aes(x=x,y=y_hat[1,],"
"0","                  ymin=y_hat[1,]-1.96*sigma2_hat^0.5,"
"0","                  ymax=y_hat[1,]+1.96*sigma2_hat^0.5, "
"0","                  fill=""95% C.S.""), alpha=0.2) +"
"0","  scale_color_manual(name=""Curves"", values=c('blue','red')) +"
"0","  scale_fill_manual(name=""Bands"", values='blue')"
"0","g_bayes"
